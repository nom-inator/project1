<html>
  <style>
    body{ 
      font-size: 15pt;
      font-family: arial;
    }
  </style>

  <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>


<body>
  <h1>Restaurant</h1>
<table border="1" style="width:100%">
  <tr>
    <td>action</td> 
    <td>rid</td>
    <td>Name</td> 
    <td>rate</td>
    <td>zip</td>
    <td>city</td>
    <td>state</td>
    <td>st_addr</td>
  </tr>
  {% for n in restaurant %}
    <tr>
    <td><p><a href="/add_fav?rid={{n['rid']}}">add to favourites</a></p></td>  
    <td><p><a href="/restaurant?rid={{n['rid']}}">{{n['rid']}}</a></p></td>
    <td>{{n['rname']}}</td> 
    <td>{{n['rate']}}</td>
    <td>{{n['zip']}}</td>
    <td>{{n['city']}}</td>
    <td>{{n['state']}}</td>
    <td>{{n['st_addr']}}</td>
    </tr>
  {% endfor %}
</table>    

    <article>

    </article>

    <script>
    if('{{display_directions}}'=='1')
    {

      function success(position) {
        var mapcanvas = document.createElement('div');
        mapcanvas.id = 'mapcontainer';
        mapcanvas.style.height = '400px';
        mapcanvas.style.width = '600px';

        document.querySelector('article').appendChild(mapcanvas);

        var coords = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
        
        var options = {
          zoom: 15,
          center: coords,
          mapTypeControl: false,
          navigationControlOptions: {
            style: google.maps.NavigationControlStyle.SMALL
          },
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        var map = new google.maps.Map(document.getElementById("mapcontainer"), options);

        var marker = new google.maps.Marker({
            position: coords,
            map: map,
            title:"You are here!"
        });

        var directionsDisplay = new google.maps.DirectionsRenderer({
          map: map
        });

        // Set destination, origin and travel mode.
        var request = {
          destination: {lat: {{restaurant[0]['lat']}}, lng: {{restaurant[0]['lng']}}},
          origin: coords,
          travelMode: google.maps.TravelMode.TRANSIT
        };

        // Pass the directions request to the directions service.
        var directionsService = new google.maps.DirectionsService();
        directionsService.route(request, function(response, status) {
          if (status == google.maps.DirectionsStatus.OK) {
            // Display the route on the map.
            directionsDisplay.setDirections(response);
          }
        });
      }

      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(success);
      } else {
        error('Geo Location is not supported');
      }

    }

    </script>

<p><a href="/">main page</a></p>


</body>


</html>
